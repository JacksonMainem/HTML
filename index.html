<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Infix to Prefix Converter</title>
<style>
body { font-family: Arial, sans-serif; background: #f2f2f2; padding: 30px; }
input, button { width: 100%; padding: 10px; font-size: 16px; margin-top: 10px; }
#result { margin-top: 15px; font-weight: bold; }
</style>
</head>
<body>

<h2>Infix to Prefix Converter</h2>

<input type="text" id="infix" placeholder="Enter Infix Expression (e.g., A+B*C-D/E)">
<button onclick="convert()">Convert</button>

<div id="result"></div>

<script>
// ================= OPERATORS =================
function precedence(c) {
    if (c === '+' || c === '-') return 1;
    if (c === '*' || c === '/' || c === '%') return 2;
    if (c === '^') return 3;
    return -1;
}

function isOperator(c) {
    return "+-*/^%".includes(c);
}

// ================= VALIDATION =================
function validateInfix(exp) {
    exp = exp.trim();
    if (!exp) return { valid:false, message:"‚ùå Please enter an expression" };

    let stack = [];
    let lastWasOperator = true;
    let hasOperator = false;

    for (let i = 0; i < exp.length; i++) {
        let c = exp[i];
        if (c === ' ') continue;

        if (/[A-Z]/.test(c)) {
            if (!lastWasOperator)
                return { valid:false, message:"‚ùå Two operands together not allowed" };
            lastWasOperator = false;
        }
        else if (/[a-z]/.test(c))
            return { valid:false, message:"‚ùå Lowercase letters not allowed" };
        else if (/[0-9]/.test(c))
            return { valid:false, message:"‚ùå Numbers not allowed" };
        else if (isOperator(c)) {
            if (lastWasOperator)
                return { valid:false, message:"‚ùå Two operators together not allowed" };
            lastWasOperator = true;
            hasOperator = true;
        }
        else if (c === '(') {
            stack.push(c);
            lastWasOperator = true;
        }
        else if (c === ')') {
            if (!stack.length)
                return { valid:false, message:"‚ùå Unbalanced parentheses" };
            stack.pop();
            lastWasOperator = false;
        }
        else
            return { valid:false, message:"‚ùå Invalid character" };
    }

    if (stack.length)
        return { valid:false, message:"‚ùå Unbalanced parentheses" };
    if (!hasOperator)
        return { valid:false, message:"‚ùå Expression must contain an operator" };

    return { valid:true };
}

// ================= INFIX ‚Üí POSTFIX (FOR PREFIX) =================
function infixToPostfix(exp) {
    let stack = [];
    let output = "";

    for (let c of exp) {
        if (/[A-Z]/.test(c)) {
            output += c;
        }
        else if (c === '(') {
            stack.push(c);
        }
        else if (c === ')') {
            while (stack.length && stack[stack.length - 1] !== '(')
                output += stack.pop();
            stack.pop();
        }
        else if (isOperator(c)) {
            // üî¥ IMPORTANT FIX: STRICT <
            while (stack.length &&
                   precedence(c) < precedence(stack[stack.length - 1])) {
                output += stack.pop();
            }
            stack.push(c);
        }
    }

    while (stack.length)
        output += stack.pop();

    return output;
}

// ================= INFIX ‚Üí PREFIX =================
function infixToPrefix(infix) {
    let validation = validateInfix(infix);
    if (!validation.valid) return validation.message;

    // Reverse
    let rev = infix.split('').reverse().join('');
    rev = rev.replace(/\(/g,'#').replace(/\)/g,'(').replace(/#/g,')');

    let postfix = infixToPostfix(rev);
    return postfix.split('').reverse().join('');
}

// ================= RUN =================
function convert() {
    let infix = document.getElementById("infix").value;
    let result = infixToPrefix(infix);
    document.getElementById("result").innerText =
        "Prefix Expression: " + result;
}
</script>

</body>
</html>
